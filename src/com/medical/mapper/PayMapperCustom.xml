<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.medical.mapper.PayMapperCustom" >
  <insert id="insertSelectiveReturnId" keyProperty="payid" useGeneratedKeys="true" parameterType="com.medical.po.Pay" >
    insert into pay
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="payid != null" >
        payId,
      </if>
      <if test="payorderid != null" >
        payOrderId,
      </if>
      <if test="paytradeno != null" >
        PayTradeNo,
      </if>
      <if test="payalipaytradeno != null" >
        payAlipayTradeNo,
      </if>
      <if test="paywxtradeno != null" >
        payWXTradeNo,
      </if>
      <if test="paytotalamount != null" >
        payTotalAmount,
      </if>
      <if test="payreceiptamount != null" >
        payReceiptAmount,
      </if>
      <if test="paycreattime != null" >
        payCreatTime,
      </if>
      <if test="payendtime != null" >
        payEndTime,
      </if>
      <if test="paybuyerid != null" >
        payBuyerId,
      </if>
      <if test="paysellerid != null" >
        paySellerId,
      </if>
      <if test="paysellername != null" >
        paySellerName,
      </if>
      <if test="paytypeid != null" >
        payTypeId,
      </if>
      <if test="paystateid != null" >
        payStateId,
      </if>
      <if test="paymodeid != null" >
        payModeId,
      </if>
      <if test="payremark != null" >
        payRemark,
      </if>
      <if test="paybuyername != null" >
        payBuyerName,
      </if>
      <if test="payinfo != null" >
        payInfo,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="payid != null" >
        #{payid,jdbcType=INTEGER},
      </if>
      <if test="payorderid != null" >
        #{payorderid,jdbcType=INTEGER},
      </if>
      <if test="paytradeno != null" >
        #{paytradeno,jdbcType=VARCHAR},
      </if>
      <if test="payalipaytradeno != null" >
        #{payalipaytradeno,jdbcType=VARCHAR},
      </if>
      <if test="paywxtradeno != null" >
        #{paywxtradeno,jdbcType=VARCHAR},
      </if>
      <if test="paytotalamount != null" >
        #{paytotalamount,jdbcType=DECIMAL},
      </if>
      <if test="payreceiptamount != null" >
        #{payreceiptamount,jdbcType=DECIMAL},
      </if>
      <if test="paycreattime != null" >
        #{paycreattime,jdbcType=TIMESTAMP},
      </if>
      <if test="payendtime != null" >
        #{payendtime,jdbcType=TIMESTAMP},
      </if>
      <if test="paybuyerid != null" >
        #{paybuyerid,jdbcType=INTEGER},
      </if>
      <if test="paysellerid != null" >
        #{paysellerid,jdbcType=INTEGER},
      </if>
      <if test="paysellername != null" >
        #{paysellername,jdbcType=VARCHAR},
      </if>
      <if test="paytypeid != null" >
        #{paytypeid,jdbcType=INTEGER},
      </if>
      <if test="paystateid != null" >
        #{paystateid,jdbcType=INTEGER},
      </if>
      <if test="paymodeid != null" >
        #{paymodeid,jdbcType=INTEGER},
      </if>
      <if test="payremark != null" >
        #{payremark,jdbcType=VARCHAR},
      </if>
      <if test="paybuyername != null" >
        #{paybuyername,jdbcType=VARCHAR},
      </if>
      <if test="payinfo != null" >
        #{payinfo,jdbcType=LONGVARCHAR},
      </if>
    </trim>
  </insert>
  <select id="selectByPayTradeNo" resultType="com.medical.po.Pay" parameterType="String" >
    select *
    
    from pay
    where payTradeNo = #{0}
  </select>
  <select id="selectByLoginIdAndType" resultType="map" parameterType="java.lang.Integer" >
    select a.payid,a.payorderid,a.paytradeno,a.paymodeid,b.paymodename,a.payalipaytradeno,a.paywxtradeno,a.paytotalamount,a.payreceiptamount,
   a.paycreattime,a.payendtime,a.paytypeid,c.paytypename,a.paystateid,d.paystatename,a.payremark,a.paysellername as payreceivername,
   a.paybuyername as paysendername 
    from pay as a
    	left join paymode as b on a.payModeId= b.payModeId
    	left join paytype as c on a.payTypeId =c.payTypeId
    	left join paystate as d on a.payStateId= d.payStateId
    where  
    <if test="param2==1">
    	 (a.payBuyerId=#{0} and a.payTypeId=1) or (a.payBuyerId=#{0} and a.payTypeId=2) or (a.paySellerId=#{0} and a.payTypeId=4) 
    </if>
    <if test="param2==2">
    (a.paySellerId=#{0} and a.payTypeId=1) or (a.paySellerId=#{0} and a.payTypeId=3) or (a.paySellerId=#{0} and a.payTypeId=5) 
    </if>
    <if test="param2==3">
    	 (a.payBuyerId=#{0} and a.payTypeId=3) or (a.paySellerId=#{0} and a.payTypeId=2) or (a.paySellerId=#{0} and a.payTypeId=6)
    </if>
    order by a.payCreatTime desc
  </select>
</mapper>
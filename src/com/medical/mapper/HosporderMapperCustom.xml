<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.medical.mapper.HosporderMapperCustom" >
  <!--医生获取不同类型的会诊订单  -->
  <select id="listByDocLoginIdAndType" parameterType="java.lang.Integer" resultType="map">
  	select a.hosporderid,a.orderabs,a.orderstime,a.orderstate,k.hosporderstatename as orderstatename,
  			a.ordertotalhospprice,a.ordertotaldoctorprice,a.orderhospprice,a.orderdoctorprice,
  			a.orderhosptpricetype,e.pricetypename as orderhosptpricetypename,a.orderhosptprice,
  			a.orderhospapricetype,f.pricetypename as orderhospapricetypename,a.orderhospaprice,
  			a.orderhospepricetype,g.pricetypename as orderhospepricetypename,a.orderhospeprice,
  			a.orderdoctortpricetype,h.pricetypename as orderdoctortpricetypename,a.orderdoctortprice,
  			a.orderdoctorapricetype,i.pricetypename as orderdoctorapricetypename,a.orderdoctoraprice,
  			a.orderdoctorepricetype,j.pricetypename as orderdoctorepricetypename,a.orderdoctoreprice,
  			c.hosploginid,c.hospname,c.hospGrade as hosplevelname,b.hosphuanxinaccount,b.hosploginpix
  		from hosporder as a
  		left join hosplogininfo as b on a.HospId=b.hospLoginId
  		left join hospinfo as c on c.hospLoginId= b.hospLoginId
  		left join pricetype as e on e.priceTypeId=a.OrderHospTPriceType
  		left join pricetype as f on f.priceTypeId=a.OrderHospAPriceType
  		left join pricetype as g on g.priceTypeId=a.OrderHospEPriceType
  		left join pricetype as h on h.priceTypeId=a.OrderDoctorTPriceType
  		left join pricetype as i on i.priceTypeId=a.OrderDoctorAPriceType
  		left join pricetype as j on j.priceTypeId=a.OrderDoctorEPriceType
  		left join hosporderstate as k on a.orderstate= k.hosporderstateid
  	where a.DoctorId= #{0} 
  	<if test="param2==1">
  		and a.OrderState=1
  		ORDER BY OrderPTime DESC
  	</if>
  	<if test="param2==2">
  		and a.OrderState=2
  		ORDER BY OrderRTime DESC
  	</if>
  	
  	<if test="param2==3">
  		and a.OrderState<![CDATA[ > ]]>2 and a.OrderState<![CDATA[ < ]]>4
  		ORDER BY OrderSTime ASC
  	</if>
  	<if test="param2==4">
  		and a.OrderState=4
  		ORDER BY OrderETime DESC
  	</if>
  	<if test="param2==5">
  		and a.OrderState<![CDATA[ >= ]]>4 
  		ORDER BY OrderETime DESC
  	</if>
  	 
  </select>
  <!-- 按医生和订单id查询会诊详情 -->
  <select id="selectAllInfoByDocLoginIdAndHospOrderId" parameterType="java.lang.Integer" resultType="map">
  	select a.hosporderid,a.orderabs,a.orderstime,a.orderptime,a.orderrtime,a.orderetime,
  			a.orderstate,k.hosporderstatename as orderstatename,
  			a.ordertotalhospprice,a.ordertotaldoctorprice,a.orderhospprice,a.orderdoctorprice,
  			a.orderhosptpricetype,e.pricetypename as orderhosptpricetypename,a.orderhosptprice,
  			a.orderhospapricetype,f.pricetypename as orderhospapricetypename,a.orderhospaprice,
  			a.orderhospepricetype,g.pricetypename as orderhospepricetypename,a.orderhospeprice,
  			a.orderdoctortpricetype,h.pricetypename as orderdoctortpricetypename,a.orderdoctortprice,
  			a.orderdoctorapricetype,i.pricetypename as orderdoctorapricetypename,a.orderdoctoraprice,
  			a.orderdoctorepricetype,j.pricetypename as orderdoctorepricetypename,a.orderdoctoreprice,
  			c.hosploginid,c.hospname,c.hospGrade as hosplevelname,b.hosphuanxinaccount,b.hosploginpix,
  			c.hospabs,c.hospfeature,c.hospadrprovince,c.hospadrcity,c.hospadrarea,c.hospadrother,c.hospadrlon,c.hospadrlat
  		from hosporder as a
  		left join hosplogininfo as b on a.HospId=b.hospLoginId
  		left join hospinfo as c on c.hospLoginId= b.hospLoginId
  		
  		left join pricetype as e on e.priceTypeId=a.OrderHospTPriceType
  		left join pricetype as f on f.priceTypeId=a.OrderHospAPriceType
  		left join pricetype as g on g.priceTypeId=a.OrderHospEPriceType
  		left join pricetype as h on h.priceTypeId=a.OrderDoctorTPriceType
  		left join pricetype as i on i.priceTypeId=a.OrderDoctorAPriceType
  		left join pricetype as j on j.priceTypeId=a.OrderDoctorEPriceType
  		left join hosporderstate as k on a.orderstate= k.hosporderstateid
  		
  	where a.DoctorId= #{0} and a.HospOrderId=#{1}
  	
  	 
  </select>
  <select id="selectByHospLoginId" parameterType="java.lang.Integer"  resultType="map">
  	select a.hosporderid,a.hospid,a.doctorid,b.docname,b.docmale,b.doctitle,b.dochosp,
	  	a.orderstate,c.hosporderstatename,a.orderabs,a.orderptime,a.orderrtime,a.orderetime,a.orderstime,a.ordertotalhospprice,
	  	a.ordertotaldoctorprice
  	 from hosporder as a 
  	 left join doctorinfo as b on b.docloginid=a.DoctorId
  	 left join hosporderstate as c on a.OrderState=c.HospOrderStateId
  	 where a.HospId=#{0} 
  	 <if test="param2==1">
  	 	and a.OrderState=1
  	 </if>
  	 <if test="param2==2">
  	 	and a.OrderState=2
  	 </if>
  	 <if test="param2==3">
  	 	and a.OrderState=3
  	 </if>
  	 <if test="param2==4">
  	 	and a.OrderState=4
  	 </if>
  	 <if test="param2==5">
  	 	and (a.OrderState=6 or a.OrderState=7) 
  	 </if>
  	</select>
</mapper>
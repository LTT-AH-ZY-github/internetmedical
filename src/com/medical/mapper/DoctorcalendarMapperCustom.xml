<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.medical.mapper.DoctorcalendarMapperCustom" >
 
  <select id="selectByDocloginid" resultType="com.medical.po.Doctorcalendar" parameterType="java.lang.Integer" >
    select *
   	from doctorcalendar
    where docLoginId = #{0,jdbcType=INTEGER}
  </select>
  <!--查询日程及地址信息  -->
  <select id="selectAllInfoByDocloginid" resultType="map" parameterType="com.medical.po.custom.CalendarParmas" >
    select a.doccalendarid,a.doccalendarday,a.doccalendartime,a.doccalendaraffair,a.doccalendaradressid,
    	b.docaddresslocation,b.docaddressprovince,b.docaddresscity,b.docaddressarea,b.docaddressother,b.docaddresslon,b.docaddresslat
   	from doctorcalendar as a 
   		left join doctoraddress as b on a.docCalendarAdressId = b.docAddressId 
    where a.docLoginId = #{id}
    <if test="time!=null">
   		and date_format(a.docCalendarDay,'%Y-%m')=#{time}
   	</if> 
  </select>
   <select id="selectAllInfoByDocCalendarId" resultType="map" parameterType="java.lang.Integer" >
    select a.doccalendarid,a.doccalendarday,a.doccalendartime,a.doccalendaraffair,a.doccalendaradressid,
    	b.docaddresslocation,b.docaddressprovince,b.docaddresscity,b.docaddressarea,b.docaddressother,b.docaddresslon,b.docaddresslat
   	from doctorcalendar as a 
   		left join doctoraddress as b on a.docCalendarAdressId = b.docAddressId 
    where a.doccalendarid = #{0}
    
  </select>
  <!--根据时间查询日程-->
  <select id="selectByDayAndTime" resultType="com.medical.po.Doctorcalendar" parameterType="java.lang.String" >
    select *
   	from doctorcalendar 
   	where docCalendarDay = #{0}
   	
 </select>
 <select id="selectAllInfoByDocloginidInUser" resultType="map" parameterType="com.medical.po.custom.CalendarParmas" >
    select a.doccalendarid,a.doccalendarday,a.doccalendartime,a.doccalendaraffair,a.doccalendaradressid,
    	b.docaddresslocation,b.docaddressprovince,b.docaddresscity,b.docaddressarea,b.docaddressother,b.docaddresslon,b.docaddresslat
   	from doctorcalendar as a 
   		left join doctoraddress as b on a.docCalendarAdressId = b.docAddressId 
    where  date_add(CURDATE(), INTERVAL 30 DAY) <![CDATA[ >= ]]> a.docCalendarDay and a.docCalendarDay<![CDATA[ >= ]]>CURDATE()
    ORDER BY a.docCalendarDay ASC
    </select>
 <insert id="insertSelectiveReturnId" useGeneratedKeys="true" keyProperty="doccalendarid" parameterType="com.medical.po.Doctorcalendar" >
    insert into doctorcalendar
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="doccalendarid != null" >
        docCalendarId,
      </if>
      <if test="doccalendarday != null" >
        docCalendarDay,
      </if>
      <if test="doccalendartime != null" >
        docCalendarTime,
      </if>
      <if test="doccalendaraffair != null" >
        docCalendarAffair,
      </if>
      <if test="doccalendaradressid != null" >
        docCalendarAdressId,
      </if>
      <if test="docloginid != null" >
        docLoginId,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="doccalendarid != null" >
        #{doccalendarid,jdbcType=INTEGER},
      </if>
      <if test="doccalendarday != null" >
        #{doccalendarday,jdbcType=DATE},
      </if>
      <if test="doccalendartime != null" >
        #{doccalendartime,jdbcType=CHAR},
      </if>
      <if test="doccalendaraffair != null" >
        #{doccalendaraffair,jdbcType=VARCHAR},
      </if>
      <if test="doccalendaradressid != null" >
        #{doccalendaradressid,jdbcType=INTEGER},
      </if>
      <if test="docloginid != null" >
        #{docloginid,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  
    
</mapper>